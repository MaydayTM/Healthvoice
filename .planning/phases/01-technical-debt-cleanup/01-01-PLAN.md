---
phase: 01-technical-debt-cleanup
plan: 01
type: execute
depends_on: []
files_modified: [components/EditModal.tsx, app/(tabs)/index.tsx]
---

<objective>
Create a functional Edit Modal for health logs, allowing users to modify logged entries.

Purpose: Fix the TODO stub for handleEdit and provide users ability to correct mistakes in their logs.
Output: Working EditModal component integrated into the timeline screen.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-plan.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@app/(tabs)/index.tsx
@components/LogItem.tsx
@components/ClarifyModal.tsx
@types/index.ts
@constants/theme.ts

**Constraints:**
- Maintain Renaissance UI aesthetic (warm paper colors, subtle shadows)
- Dutch language for all user-facing text
- Follow existing modal patterns from ClarifyModal.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create EditModal component</name>
  <files>components/EditModal.tsx</files>
  <action>
Create a new EditModal component that:
1. Accepts a HealthLog object and callbacks (onSave, onDismiss)
2. Shows a modal with fields appropriate to the log's category:
   - voeding: items (TextInput), meal_type (dropdown)
   - supplement: name, dosage, quantity
   - beweging: activity, duration, intensity
   - slaap: duration_hours, quality
   - welzijn: type, level (1-10), description
   - overig: description
3. Pre-fills all fields from the existing log
4. Shows category badge at the top (matching LogItem style)
5. Has "Annuleren" and "Opslaan" buttons
6. Uses Modal from react-native with transparent background
7. Style matches ClarifyModal aesthetic (paper background, ink borders, amber accent for primary button)

Use Picker from @react-native-picker/picker for dropdown fields if available, otherwise use a simple button-based selector.
  </action>
  <verify>Component file exists and has no TypeScript errors: `npx tsc --noEmit`</verify>
  <done>EditModal.tsx exists with all category-specific form fields, proper typing, and Renaissance-style UI</done>
</task>

<task type="auto">
  <name>Task 2: Integrate EditModal into Timeline</name>
  <files>app/(tabs)/index.tsx</files>
  <action>
1. Import EditModal component
2. Add state for selectedLog: `const [editingLog, setEditingLog] = useState<HealthLog | null>(null)`
3. Update handleEdit to set the selected log: `setEditingLog(log)`
4. Remove the console.log statement from handleEdit
5. Add handleSaveEdit function that:
   - Calls editLog(log.id, updates) from useLogs hook
   - Clears editingLog state
   - Shows success feedback (optional: use existing processingBanner pattern)
6. Render EditModal at bottom of component (next to ClarifyModal):
   ```
   <EditModal
     visible={editingLog !== null}
     log={editingLog}
     onSave={handleSaveEdit}
     onDismiss={() => setEditingLog(null)}
   />
   ```
  </action>
  <verify>Edit button on LogItem opens modal with pre-filled data, saving updates the log</verify>
  <done>Edit modal opens when clicking edit icon, shows correct data, saves changes to database</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Edit Modal for health logs</what-built>
  <how-to-verify>
    1. Run: `npx expo start`
    2. Open app on device/simulator
    3. If no logs exist, create one by holding voice button and saying "Ik at een appel"
    4. Tap the edit (pencil) icon on a log item
    5. Verify: Modal opens with pre-filled data
    6. Modify a field (e.g., change "appel" to "banaan")
    7. Tap "Opslaan"
    8. Verify: Modal closes, log shows updated content
    9. Pull to refresh
    10. Verify: Change persisted (data reloaded from database)
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npx tsc --noEmit` passes without errors
- [ ] EditModal renders correctly for all 6 categories
- [ ] Edit icon opens modal with correct pre-filled data
- [ ] Changes save to database and persist after refresh
- [ ] No console.log statements remain in handleEdit
</verification>

<success_criteria>
- EditModal component created with category-specific fields
- Edit functionality works end-to-end
- UI matches existing Renaissance aesthetic
- Dutch language used throughout
- No TypeScript errors
</success_criteria>

<output>
After completion, create `.planning/phases/01-technical-debt-cleanup/01-01-SUMMARY.md`
</output>
